clear all
clc

Lon=5.6;    %16
Wid=5.6;    %7
Hei=2.5;    %4

Vol=Lon*Wid*Hei;
SA_floor =Lon*Wid;  
SA_ws = Hei*(Lon+Wid)*2;
SA_ceiling=SA_floor;
SA_nose=0.80;
filter_flow_rate = 137;
ACH=4;
Q=(Vol*ACH)/60;
SA_filter=Q/filter_flow_rate;

prop_trac=0.75;
SA_htf=SA_floor*prop_trac*0.25;             %higher tracked area
SA_ltf=SA_floor*prop_trac*0.75;             %lower tracker area
SA_utf=SA_floor*(1-prop_trac);              %untracked area
SA_h=2e-3;                                  %finger area



rho=1000;                                %density of the particle
D=[2.81e-11,8.48e-12,4.98e-12,2.45e-12]; %Particle diffusivity
k_e=(0.45+0.0)/2;                        %turbulence intensity   
%%%%%%%%%%%settling velocity%%%%%%%%%%%%%%%%
v_g(:,1)=9.8*((1.0e-6)^2)*(rho-1.2)/(18*1.81e-5);     %m/s
v_g(:,2)=9.8*((3.0e-6)^2)*(rho-1.2)/(18*1.81e-5);     %m/s
v_g(:,3)=9.8*((5.0e-6)^2)*(rho-1.2)/(18*1.81e-5);     %m/s
v_g(:,4)=9.8*((10.0e-6)^2)*(rho-1.2)/(18*1.81e-5);    %m/s

%%%%%%%%%%%deposition velocity%%%%%%%%%%%%%%%%
for i=1:20
    ii=mod(i,4);
    if ii==0;
        iii=4;
    else iii=ii;
    end
dep_trac(i)=(v_g(iii)/(1-exp(-1.571*v_g(iii)/(D(iii)*k_e(1))^0.5)))*60;
dep_wall(i)=((1/1.571)*((D(iii)*k_e(1))^0.5))*60; 
dep_ceiling(i)=(v_g(iii)/(exp(1.571*v_g(iii)/(D(iii)*k_e(1))^0.5)-1))*60;
 end
dep_untrac=dep_trac;

e_nose=[0.14,0.45,0.62,0.77];
e_nose=repmat(e_nose,1,5);
resus=[1.2 * 10^(-4)/60, 1.9*10^(-3)/60, 3.8*10^(-3)/60, 3.4*10^(-2)/60];
resus=repmat(resus,1,5);
eff=[0.098, 0.49, 0.74, 0.88];
eff=repmat(eff,1,5);

p=.8;
rsh=6/60;       %surface hand touch rate per min
rhs=6/60;       %hand surface touch rate per min
rhm=8/60;       %hand mouth touch rate per min
fsh=0.333;      %fraction surface hand 
fhs=0.174;      %fraction hand surface 
fhm=0.350;      %fraction hand mouth 
r11=[1.4e-6,1.4e-6,1.4e-6,1.4e-6,4.6e-2,4.6e-2,4.6e-2,4.6e-2,5.0e-2,5.0e-2,5.0e-2,5.0e-2,7.6e-4,7.6e-4,7.6e-4,7.6e-4,4.3e-2,4.3e-2,4.3e-2,4.3e-2];  %decay in the air
%r11=[1.9e-7,1.9e-7,1.9e-7,1.9e-7,3.50e-2,3.50e-2,3.50e-2,3.50e-2,9.17e-3,9.17e-3,9.17e-3,9.17e-3,1.67e-4,1.67e-4,1.67e-4,1.67e-4,1.30e-2,1.30e-2,1.30e-2,1.30e-2];  %decay in the air (lower bound)
r22=[5.6e-7,5.6e-7,5.6e-7,5.6e-7,7.5e-3,7.5e-3,7.5e-3,7.5e-3,4.0e-3,4.0e-3,4.0e-3,4.0e-3,1.2e-4,1.2e-4,1.2e-4,1.2e-4,1.3e-2,1.3e-2,1.3e-2,1.3e-2];  %decay at other places
%r22=[3.20e-7,3.20e-7,3.20e-7,3.20e-7,6.67e-4,6.67e-4,6.67e-4,6.67e-4,1.67e-4,1.67e-4,1.67e-4,1.67e-4,9.08e-5,9.08e-5,9.08e-5,9.08e-5,1.13e-2,1.13e-2,1.13e-2,1.13e-2];  %decay at other places (lower bound)
tdr33=[7.15*10^-6,7.15*10^-6,7.15*10^-6,7.15*10^-6,1.02*10^-3,1.02*10^-3,1.02*10^-3,1.02*10^-3,5.32*10^-2,5.32*10^-2,5.32*10^-2,5.32*10^-2,2.31*10^-6,2.31*10^-6,2.31*10^-6,2.31*10^-6,3.58*10^-2,3.58*10^-2,3.58*10^-2,3.58*10^-2];
tdr44=[3.14*10^-8,1.15*10^-8,6.36*10^-9,2.61*10^-9,1.02*10^-3,1.02*10^-3,1.02*10^-3,1.02*10^-3,5.32*10^-2,5.32*10^-2,5.32*10^-2,5.32*10^-2,2.31*10^-6,2.31*10^-6,2.31*10^-6,2.31*10^-6,3.58*10^-2,3.58*10^-2,3.58*10^-2,3.58*10^-2];

r=1.02/60;

%M_Init=[1.30e4,2.98e4,4.40e4,7.00e4,3.00e2,4.10e2,5.10e2,7.10e2,6.00,8.10,9.74,13.50,4.00e4,9.10e4,1.35e5,2.00e5,8.00e0,1.11e1,1.39e1,2.00e1];  %air release

TMax =60*24;
stp=TMax;

kk=1;

%%%%0-8 hours%%%%%%%%
%RE=[1377.17372834871,940.628186837448,940.628186837448,1104.35561276283,...
%    242.686072483350,149.958811923193,90.8174948275481,40.6976015001397,...
%    4.65989470711171,2.35587945939438,1.29033518099061,0.528402080980977,...
%    28926.7262403946,17874.1921835445,10877.6075647416,5416.14364776767,...
%    7.31736215307654,5.33614976999840,3.68147686136579,1.75230703591318];
%%%%%0-24 hours%%%%%%%
RE=[147.690246965826,102.922585352361,102.922585352361,134.263860878023,...
    169.946865951446,52.2874046206282,25.6495429685100,11.0412871994297,...
    2.47645910304215,0.639151713113147,0.295187301328567,0.120881447393713,...
    7352.78569558869,2173.08448918424,1257.64928528404,658.476625477557,...
    5.69351339925597,2.29703750363335,1.27081509319242,0.538949654414711];

NN=0;

i=1;
while(i<=20)
   
    Compu_utf_same_risk
    
if Risk_tF(stp,i)<=9.95e-4
    RE(1,i)=RE(1,i)*1.1;
    Compu_utf_same_risk


else if Risk_tF(stp,i)>=1.05e-3
    RE(1,i)=RE(1,i)*0.9;
    Compu_utf_same_risk

    else
        i=i+1
        
    end
end
    
end

%RE_F(ttt,:)=RE;

    





