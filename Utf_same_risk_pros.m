clear all
clc
tic

Lon=5.6;    %16
Wid=5.6;    %7
Hei=2.5;    %4

Vol=Lon*Wid*Hei;
SA_floor =Lon*Wid;  
SA_ws = Hei*(Lon+Wid)*2;
SA_ceiling=SA_floor;
SA_nose=0.80;
filter_flow_rate = 137;
ACH=4;
Q=(Vol*ACH)/60;
SA_filter=Q/filter_flow_rate;

prop_trac=0.75;
SA_htf=SA_floor*prop_trac*0.25;             %higher tracked area
SA_ltf=SA_floor*prop_trac*0.75;             %lower tracker area
SA_utf=SA_floor*(1-prop_trac);              %untracked area
SA_h=2e-3;                                  %finger area



rho=1000;                                %density of the particle
D=[2.81e-11,8.48e-12,4.98e-12,2.45e-12]; %Particle diffusivity
k_e=(0.45+0.0)/2;                        %turbulence intensity   
%%%%%%%%%%%settling velocity%%%%%%%%%%%%%%%%
v_g(:,1)=9.8*((1.0e-6)^2)*(rho-1.2)/(18*1.81e-5);     %m/s
v_g(:,2)=9.8*((3.0e-6)^2)*(rho-1.2)/(18*1.81e-5);     %m/s
v_g(:,3)=9.8*((5.0e-6)^2)*(rho-1.2)/(18*1.81e-5);     %m/s
v_g(:,4)=9.8*((10.0e-6)^2)*(rho-1.2)/(18*1.81e-5);    %m/s

%%%%%%%%%%%deposition velocity%%%%%%%%%%%%%%%%
for i=1:20
    ii=mod(i,4);
    if ii==0;
        iii=4;
    else iii=ii;
    end
dep_trac(i)=(v_g(iii)/(1-exp(-1.571*v_g(iii)/(D(iii)*k_e(1))^0.5)))*60;
dep_wall(i)=((1/1.571)*((D(iii)*k_e(1))^0.5))*60; 
dep_ceiling(i)=(v_g(iii)/(exp(1.571*v_g(iii)/(D(iii)*k_e(1))^0.5)-1))*60;
 end
dep_untrac=dep_trac;

e_nose=[0.14,0.45,0.62,0.77];
e_nose=repmat(e_nose,1,5);
resus=[2.00e-6, 3.17e-5, 6.33e-5, 5.67e-4];
resus=repmat(resus,1,5);
eff=[0.098, 0.49, 0.74, 0.88];
eff=repmat(eff,1,5);

p=.75;
rsh=6/60;       %surface hand touch rate per min
rhs=6/60;       %hand surface touch rate per min
rhm=8/60;       %hand mouth touch rate per min
fsh=0.333;      %fraction surface hand 
fhs=0.174;      %fraction hand surface 
fhm=0.350;      %fraction hand mouth 
r11=[8.16e-5/60,8.16e-5/60,8.16e-5/60,8.16e-5/60,2.75/60,2.75/60,2.75/60,2.75/60,3.27/60,3.27/60,3.27/60,3.27/60,0.0455/60,0.0455/60,0.0455/60,0.0455/60,2.6/60,2.6/60,2.6/60,2.6/60];  %decay in the air
%r11=[1.9e-7,1.9e-7,1.9e-7,1.9e-7,3.50e-2,3.50e-2,3.50e-2,3.50e-2,9.17e-3,9.17e-3,9.17e-3,9.17e-3,1.67e-4,1.67e-4,1.67e-4,1.67e-4,1.30e-2,1.30e-2,1.30e-2,1.30e-2];  %decay in the air (lower bound)
r22=[3.36e-5/60,3.36e-5/60,3.36e-5/60,3.36e-5/60,0.455/60,0.455/60,0.455/60,0.455/60,0.239/60,0.239/60,0.239/60,0.239/60,0.00689/60,0.00689/60,0.00689/60,0.00689/60,0.767/60,0.767/60,0.767/60,0.767/60];  %decay at other places
%r22=[3.20e-7,3.20e-7,3.20e-7,3.20e-7,6.67e-4,6.67e-4,6.67e-4,6.67e-4,1.67e-4,1.67e-4,1.67e-4,1.67e-4,9.08e-5,9.08e-5,9.08e-5,9.08e-5,1.13e-2,1.13e-2,1.13e-2,1.13e-2];  %decay at other places (lower bound)
tdr33=[7.15*10^-6,7.15*10^-6,7.15*10^-6,7.15*10^-6,1.02*10^-3,1.02*10^-3,1.02*10^-3,1.02*10^-3,5.32*10^-2,5.32*10^-2,5.32*10^-2,5.32*10^-2,2.31*10^-6,2.31*10^-6,2.31*10^-6,2.31*10^-6,3.58*10^-2,3.58*10^-2,3.58*10^-2,3.58*10^-2];
tdr44=[3.14*10^-8,1.15*10^-8,6.36*10^-9,2.61*10^-9,1.02*10^-3,1.02*10^-3,1.02*10^-3,1.02*10^-3,5.32*10^-2,5.32*10^-2,5.32*10^-2,5.32*10^-2,2.31*10^-6,2.31*10^-6,2.31*10^-6,2.31*10^-6,3.58*10^-2,3.58*10^-2,3.58*10^-2,3.58*10^-2];

r=1.02/60;

TMax_1=24*60*2;
stp_1=TMax_1;

TMax=60*24*365;
stp=TMax;

kk=1;
%RE=repmat(1e2,1,20);

%%%%%24-inf %%%%%%%
%RE=[174.992818621608,3964.15439107033,11894.4360893118,72176.2456911491,...
%52874260.4339786,54492749.5895375,55599173.1349224,106190952.951150,...
%2984.61415858548,3107.04409295379,3138.42837672100,6397.12825766248,...
%8100,10356.2816434110,12785.5328931000,67522.4488753105,...
%4326075853.68916,4663985638.62082,4855303988.42778,8776111814.14459];

%%%%%48-inf %%%%%%%
RE=[174.992818621608,3789.49992119664,11032.6739287381,44815.7699679909,...
    3209685020702.98,3138428376721.00,3138428376721.00,3138428376721.00,...
    970299.000000000,970299.000000000,970299.000000000,1000000,...
    9509.90049900000,11623.2117210000,13310.0000000000,...
    40941.2093084429,5.31441000000000e+17,5.26126590000000e+17,...
    5.20865324100000e+17,4.78296900000000e+17];
    
%RE=[174.992818621608,3789.49992119664,11032.6739287381,44815.7699679909,...
%1055.15726692193,1044.60569425271,1044.60569425271,1034.15963731019,...
%10.0921501808264,10.0921501808264,10.0921501808264,10.5050544587651,...
%6561,7938.81000000000,9414.80149401000,28066.2511705786,52.4865785312583,...
%52.4865785312583,53.5522686779494,49.6723605921005];



NN=0;

i=1;
while(i<=20)
   
    %Compu_utf_same_risk_pros_1
    Compu_utf_same_risk_pros
    
if Risk_tF(1,i)<=9.95e-4  %stp
    RE(1,i)=RE(1,i)*1.1;
    
    %Compu_utf_same_risk_pros_1
    Compu_utf_same_risk_pros


else if Risk_tF(1,i)>=1.05e-3
    RE(1,i)=RE(1,i)*0.9;
    
    %Compu_utf_same_risk_pros_1
    Compu_utf_same_risk_pros

    else
        i=i+1
        
    end
end
    
end
Conc_htf_Init=RE/SA_htf;
%RE_F(ttt,:)=RE;


toc    





